---
description: "配置文件规范"
globs:
  - "config/**/*.yaml"
  - "config/**/*.yml"
alwaysApply: false
---

# 配置文件规范

## 核心原则
- 配置清晰可读，层级清晰
- 敏感信息必须使用环境变量
- 启动时验证配置，失败报中文错误

## YAML 编写规范
- 使用 2 空格缩进
- 键名使用 `snake_case`
- 相关配置分组
- 层级 <= 4 层

## 配置结构设计
- 顶层放服务名称等元信息
- 按功能分组（server、llm、logging 等）
- 敏感配置使用 `${ENV_VAR}` 占位符从环境变量读取

## 配置管理
- 所有密钥通过 `config.yaml` 配置（统一配置文件）
- `config.yaml` 不提交到版本控制（已在 .gitignore）
- 实例级配置可使用 `instances/<name>/config.yaml`
- 生产环境通过系统环境变量或密钥管理服务注入

## 配置校验原则
- 应用启动时立即验证必要配置
- 缺少必要配置时抛出清晰的中文错误信息
- 验证配置值的类型和范围（如端口号 1-65535）

## 禁止事项
- ❌ YAML 中硬编码 API key、token、密码
- ❌ 生产和开发配置混在一起
- ❌ 使用含糊键名（如 `x1`, `cfg2`）
- ❌ 配置层级过深（超过 4 层）
