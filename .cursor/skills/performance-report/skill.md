---
name: performance-report
description: 从多个 Git 仓库生成绩效考核表。当用户要求"生成绩效考核表"、"统计工作产出"、"生成月度报告"时使用。自动收集提交记录，AI 智能分类，输出 Markdown 格式报告。
---

# 绩效考核表生成器

从多个 Git 仓库的提交记录自动生成结构化的绩效考核表。

## 核心功能

### 1. 多仓库支持
- 交互式选择本地 Git 仓库
- 支持跨多个项目统计
- 自动识别 Git 用户信息

### 2. 智能分类
- AI 自动将提交分类到考核维度
- 支持工作产出和企业文化两大类别
- 基于 commit message 语义理解

### 3. 报告生成
- 输出 Markdown 格式表格
- 按类别分组展示
- 包含提交统计概览

## 使用流程

当用户要求生成绩效考核表时，按以下步骤操作：

### 步骤 1: 确认时间范围

询问用户统计周期：

```
请问需要统计哪个月的绩效？
- 本月（2025年2月）
- 上个月（2025年1月）
- 自定义时间范围
```

使用 AskQuestion 工具获取用户选择。

### 步骤 2: 扫描并选择仓库

1. 扫描常见开发目录（如 `d:\code-tow\` 或用户指定目录）
2. 列出所有包含 `.git` 目录的仓库
3. 使用 AskQuestion 让用户多选需要统计的仓库

示例扫描命令：

```powershell
# 扫描 d:\code-tow\ 下的所有 Git 仓库
Get-ChildItem -Path "d:\code-tow\" -Directory | Where-Object { Test-Path (Join-Path $_.FullName ".git") } | Select-Object Name, FullName
```

### 步骤 3: 收集提交记录

对每个选中的仓库执行：

```bash
# 获取指定时间范围内的提交
git log --since="2025-01-01" --until="2025-01-31" \
  --author="$(git config user.name)" \
  --pretty=format:"%h|%s|%ai" \
  --no-merges
```

数据格式：`commit_hash|commit_message|commit_date`

### 步骤 4: AI 智能分类

使用以下 prompt 让 AI 分类提交：

```
你是一个绩效考核专家。请将以下 Git 提交记录分类到对应的绩效考核维度。

**工作产出类别（70%）**：
根据项目和功能分类：
1. 流式消息/SSE升级 - SSE、WebSocket、流式响应、Deliverable/Intent事件、断点续传
2. 仪表盘可视化 - Dashboard、图表、PNG/Excel导出、背景色渲染、数据展示
3. UI组件优化 - Sidebar、Widget、Tooltip、Popup、组件体系、Token规范
4. 文件与消息可视化 - 文件上传、预览、类型支持、流式结果查看、多媒体处理
5. 国际化与样式 - i18n、多语言、样式优化、CSS规范
6. 协作与智能分析 - 在线协作、积分管理、用户反馈、AI集成

**企业文化类别（30%）**：
1. 追求卓越 - fix(lint)、chore、规范修复、性能优化、代码质量
2. 使命必达 - 关键修复、bug fix、紧急问题处理、核心功能修复
3. 志同道合 - 文档完善、团队规范、代码审查、知识分享
4. 与AI共进 - 依赖更新、新技术探索、AI工具使用、技术调研
5. 永远年轻 - 架构重构、设计优化、新技术尝试、创新实验

**提交记录**：
{commit_list}

**输出要求**：
返回 JSON 数组，每个提交包含：
- commit: 提交hash
- message: 提交信息
- repo: 仓库名称（多仓库时需要）
- category: 所属类别（如"流式消息/SSE升级"）
- type: "工作产出" 或 "企业文化"
- reason: 简短分类理由（10字以内）

示例：
[
  {
    "commit": "5c7b8eac",
    "message": "fix(lint): 修复 ESLint 错误以通过 CI 检查",
    "repo": "zeno-front-monorepo",
    "category": "追求卓越",
    "type": "企业文化",
    "reason": "代码规范修复"
  }
]
```

### 步骤 5: 生成 Markdown 报告

基于分类结果生成报告，使用表格格式，参考 [examples.md](examples.md)。

**报告结构**：
1. 标题和统计概览
2. 工作产出（70%）- 表格格式，按考核指标分组
3. 企业文化践行（30%）- 表格格式，5个固定指标

**工作产出表格格式**（单仓库）：

```markdown
### 一、工作产出（70%）

| 考核指标 | 权重（共70%） | 目标 | 关键结果（文字客观描述）| 个人自评（百分制）|
|---------|-------------|------|-------------------|-----------------|
| 项目名称 | 35% | 完成的主要功能 | 1. 流式消息/SSE升级（45次提交）：完成 SSE v2 协议...<br>2. 仪表盘可视化（35次提交）：...<br>3. UI组件优化（80次提交）：... | 95 |
| 项目名称 | 35% | 完成的次要功能 | 1. 文件与消息可视化（50次提交）：...<br>2. 国际化与样式（40次提交）：... | 90 |
```

**工作产出表格格式**（多仓库）：

```markdown
### 一、工作产出（70%）

| 考核指标 | 权重（共70%） | 目标 | 关键结果（文字客观描述）| 个人自评（百分制）|
|---------|-------------|------|-------------------|-----------------|
| 前端项目开发 | 45% | 完成核心功能 | 【仓库：zeno-front-monorepo，220次提交】<br>1. 流式消息/SSE升级（45次）：...<br>2. 仪表盘可视化（35次）：... | 95 |
| 后端服务开发 | 25% | API和数据库优化 | 【仓库：dazee-backend，80次提交】<br>1. API接口开发（50次）：...<br>2. 数据库优化（30次）：... | 90 |
```

**企业文化践行表格格式**：

```markdown
### 二、企业文化践行（30%）

| 考核指标 | 权重（共30%） | 目标 | 关键结果（文字客观描述）| 个人自评（百分制）|
|---------|-------------|------|-------------------|-----------------|
| 追求卓越 | 6% | 在工作中不断追求更高标准，主动优化工作流程和结果质量，体现精益求精的工作态度。 | 密集更新构建资源文件（60次），保持代码规范和 CI 流程稳定 | 90 |
| 使命必达 | 6% | 对承诺的任务和目标坚持到底，遇到困难时积极寻找解决方案，确保任务按时高质量完成。 | 修复关键问题50+次，包括流式消息、侧边栏、登录等核心功能 | 95 |
| 志同道合 | 6% | 与团队成员保持良好协作，积极参与团队建设，主动分享知识和经验，体现团队精神。 | 完善文档25次，清理冗余代码，维护项目质量 | 85 |
| 与AI共进 | 6% | 积极拥抱AI技术发展，主动学习和应用AI工具提升工作效率，推动AI技术在工作中的创新应用。 | 更新依赖15次，探索新技术（IndexedDB、设计系统等） | 88 |
| 永远年轻 | 6% | 保持积极向上的工作态度，勇于接受新挑战，持续学习新知识新技能，展现青春活力和创新精神。 | 架构重构10次（TinyMCE→Quill、Token规范等） | 92 |
```

**生成逻辑**：

1. **工作产出分组**：
   - 单仓库：将 6 个子类别归类到 2-3 个考核指标
   - 多仓库：按仓库分组，每个仓库作为一个考核指标
   - 根据提交数量自动分配权重（总和 70%）

2. **关键结果总结**：
   - 列出主要功能点和提交次数
   - 使用 `<br>` 换行分隔不同功能
   - 多仓库时标注仓库名称

3. **个人自评分数**：
   - 根据提交数量和质量自动生成建议分数（85-95分）
   - 注明"仅供参考，需人工调整"

### 步骤 6: 输出结果

将生成的 Markdown 报告：
1. 显示在对话中
2. 询问用户是否保存到文件
3. 如需保存，写入到工作区根目录的 `绩效考核表-YYYY-MM.md`

## 分类规则参考

详细的分类规则和关键词映射请参考 [classification.md](classification.md)。

## 快速命令

```
生成绩效考核表
生成本月绩效报告
统计上个月的工作产出
```

## 注意事项

1. **Git 用户识别**：使用 `git config user.name` 和 `git config user.email` 识别提交作者
2. **时间范围**：默认统计完整的自然月（1日-月底）
3. **多仓库合并**：所有提交按时间倒序排列
4. **AI 分类准确性**：首次生成后可让用户确认分类，必要时手动调整
5. **性能考虑**：如果仓库很大，建议限制提交数量（如最近100条）

## 实现检查清单

在完成报告生成前，确认：

- [ ] 已收集所有选中仓库的提交
- [ ] 提交时间范围正确
- [ ] AI 分类已完成（所有提交都有 category）
- [ ] 报告格式符合 Markdown 表格规范
- [ ] 统计数据准确（提交总数、分类数量）
- [ ] 用户信息已填充（如有配置）

## 配置文件（可选）

可在 `.cursor/performance-config.json` 保存用户配置：

```json
{
  "userName": "张三",
  "department": "研发部",
  "team": "最终得分",
  "manager": "李经理",
  "position": "前端开发",
  "defaultRepos": [
    "d:\\projects\\project-frontend",
    "d:\\projects\\project-backend"
  ],
  "scanPaths": [
    "d:\\projects\\",
    "d:\\code\\"
  ]
}
```

如果配置文件存在，优先使用其中的信息。

## 故障排查

### 问题：扫描不到 Git 仓库
- 检查路径是否正确
- 确认目录下有 `.git` 文件夹
- 尝试手动指定仓库路径

### 问题：提交记录为空
- 检查时间范围是否正确
- 确认 Git 用户名匹配
- 使用 `git log` 手动验证

### 问题：AI 分类不准确
- 检查 prompt 是否完整
- 提供更多上下文信息
- 必要时人工调整分类结果

## 扩展功能

未来可添加：
- 自动计算权重得分
- 支持 Excel 导出
- 可视化图表展示
- 与 GitLab/GitHub API 集成
- 团队成员对比分析

